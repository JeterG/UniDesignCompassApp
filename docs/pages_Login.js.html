<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: pages/Login.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: pages/Login.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview The login file responsible for display the login page and handeling login functionality
 * @author &lt;a href="">Ronuel Diaz&lt;/a>
 * @version 1.0.0
 */
import React, { Component } from "react";
import { navigate } from "gatsby"
import Layout from "../components/layout"
import "../components/bootstrap.css"
import { connect } from 'react-redux';
import { authenticateUser } from '../state/actions';
import { Auth } from "aws-amplify";
import config from "../aws-exports";
import SignIn from "../components/SignIn";
import { getUserbyUsername } from "../graphql_utils/utils";
import SpinningWheel from "../components/SpinningWheel"
Auth.configure(config);

/**
 * Component that handels User login and displays Login GUI
 */
class Login extends Component {
    constructor(props) {
        super(props);
        this.state = {
            password: "",
            username: "",
            user: [],
            loading: false
        };
    }
    /**
     * Changes state information dependent on the input information from front end
     */
    handleChange = (e) => {
        this.setState({ [e.target.id]: e.target.value });
    }
    /**
     * Handles user authentication by sending user information to cognito and graphql database.
     */
    handleAuth = (e) => {
        e.preventDefault();
        this.setState({ loading: true }, () => {
            Auth.signIn(this.state.username, this.state.password)
                .then((res) => {
                    console.log(res)
                    switch (res.challengeName) {
                        case "NEW_PASSWORD_REQUIRED":
                            navigate("/newPassword", { state: { username: this.state.username } });
                            break;
                        case "SOFTWARE_TOKEN_MFA":
                            break;
                        case "MFA_SETUP":
                            break;
                        case "SMS_MFA":
                            break;
                        default:
                            getUserbyUsername(this.state.username)
                                .then((res) => {
                                    const user = res.data.getUser
                                    this.props.authenticateUser(user);
                                    navigate("/")
                                })
                    }
                }, (error) => {
                    console.log(error);
                    alert(error.message);
                    this.setState({ loading: false })
                });
        })
    };
    /**
     * Navigates to the Signup page when the create account button is clicked
     */
    createAccount = (e) => {
        navigate("/SignUp");
    }
    render = () => {
        return (
            &lt;Layout>
                &lt;SignIn
                    handleAuth={this.handleAuth}
                    handleChange={this.handleChange}
                    handleAccount={this.createAccount}
                />
                {this.state.loading &amp;&amp; &lt;SpinningWheel />}&lt;/Layout>
        )
    }
}

const mapStateToProps = ({ state }) => ({ isAuthenticated: state.isAuthenticated })

const mapDispatchToProps = dispatch => ({
    authenticateUser: (auth) => dispatch(authenticateUser(auth))
})
export default connect(mapStateToProps, mapDispatchToProps)(Login);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Graph.html">Graph</a></li><li><a href="LogCard.html">LogCard</a></li><li><a href="Login.html">Login</a></li><li><a href="NewPassword.html">NewPassword</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.2</a> on Tue May 14 2019 00:51:24 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
